$(function(){$.easing.easeOutQuint=function(f,g,e,i,h){return i*((g=g/h-1)*g*g*g*g+1)+e};$.widget("ui.coverflow",{options:{containerWidth:960,containerHeight:280,backgroundColor:"",opacity:1,childElem:".childElem",currentElem:4,recenter:true,autoPlayDuration:3000,action:"click",spaceBetween:150,inactiveScale:0.5,inactiveAngle:0.2,button:{play:".play",next:".next",previous:".previous",onActive:"onactive"},autoplay:true,autoPlayLoadingImage:true,autoPlayLoadingdiv:".innerLoader",transitionDelay:1000,timer:null,loadTimer:null,tooltip:true,tooltipDiv:".tooltipInner",tooltipParent:".tooltip",sliderElement:".sliderCover",showSlider:true,tooltipH:"left",tooltipV:"bottom"},_init:function(c){var e=this.options,b=this,d=$(this.element).find(e.childElem);this.getPrefix();this._setInterface()},_create:function(b){},_setInterface:function(){var e=this.options,b=this,c=$(this.element).find(e.childElem);var d={width:e.containerWidth+"px",height:e.containerHeight+"px"};d.background=e.backgroundColor;$(this.element).css(d);e.itemSize=c.eq(0).outerWidth();e.itemHeight=c.eq(0).height();e.selectedItemClass="selectedItem";c.bind(e.action,function(){if(!$(this).hasClass(e.selectedItemClass)){b.resetLoader();c.each(function(){$(this).removeClass(e.selectedItemClass)});$(this).addClass(e.selectedItemClass);$(e.tooltipDiv).html($(this).attr("tooltipContent"));b.selectElement(this)}else{window.open($(this).attr("url"),$(this).attr("mode"))}});if(!e.showSlider){$(e.sliderElement).hide()}$(e.sliderElement).bind({slide:function(g,f){c.eq(f.value).trigger(e.action)}});$(e.button["play"]).bind("click",function(){b.resetLoader();if($(this).hasClass(e.button["onActive"])){$(this).removeClass(e.button["onActive"]);clearInterval(e.timer);clearInterval(e.loadTimer)}else{$(this).addClass(e.button["onActive"]);b.autoPlay()}});$("."+e.selectedItemClass).live({mousemove:function(g){clearTimeout(e.tooltipTimer);if(e.tooltip){$(".tooltip").css("display","block");var h=g.clientY,f=g.clientX+2;if(e.tooltipH=="right"){f-=($(e.tooltipParent).width()+2)}else{if(e.tooltipH=="center"){f-=($(e.tooltipParent).width()/2+2)}else{f+=2}}if(e.tooltipV=="bottom"){h-=($(e.tooltipParent).height()+2)}$(".tooltip").css({top:h+"px",left:f+"px"})}},mouseleave:function(){clearTimeout(e.tooltipTimer);e.tooltipTimer=setTimeout(function(){$(".tooltip").css("display","none")},300)}});$(e.button["next"]).bind("click",function(){e.currentElem++;if(e.currentElem>c.length-1){e.currentElem=0}b.moveNext()});$(e.button["previous"]).bind("click",function(){e.currentElem--;if(e.currentElem<0){e.currentElem=c.length-1}b.moveNext()});c.eq(e.currentElem).trigger(e.action);if(e.autoplay&&$(e.button["play"]).hasClass(e.button["onActive"])){this.autoPlay()}else{if(e.autoplay){$(e.button["play"]).trigger("click")}}},moveNext:function(){var d=this.options,b=this,c=$(this.element).find(d.childElem);clearInterval(d.timer);clearTimeout(d.timeOut);b.resetLoader();c.eq(d.currentElem).trigger(d.action);d.timeOut=setTimeout(function(){if(d.autoplay&&$(d.button["play"]).hasClass(d.button["onActive"])){b.autoPlay()}},d.autoPlayDuration)},autoPlay:function(){var e=this.options,c=this,d=$(this.element).find(e.childElem);clearInterval(e.timer);c.resetLoader();var b=0;if(e.autoPlayLoadingImage){e.loadTimer=setInterval(function(){b+=1;$(e.autoPlayLoadingdiv).css("width",b+"%")},e.autoPlayDuration/100)}e.timer=setInterval(function(){if(e.currentElem>=d.length-1){e.currentElem=-1}d.eq(e.currentElem+1).trigger(e.action);c.resetLoader();$(e.autoPlayLoadingImage).show();var f=0;if(e.autoPlayLoadingImage){e.loadTimer=setInterval(function(){f+=1;$(e.autoPlayLoadingdiv).css("width",f+"%")},e.autoPlayDuration/100)}},e.autoPlayDuration)},resetLoader:function(){var b=this.options;clearInterval(b.loadTimer);$(b.autoPlayLoadingdiv).css("width","0%")},_refresh:function(c,h,g){var b=this,e=null,d=this.options,f=$(this.element).find(d.childElem);f.each(function(m){var l=(m==g&&h-g<0)||m-g>0?"left":"right",k=m==g?(1-c):(m==h?c:1),n=(m>h&&m!=g),j={zIndex:f.length+(l=="left"?g-m:m-g)};if(d.prefix=="-ms-"){j.filter="progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand', M11=1, M12=0, M21="+(k*(l=="right"?-d.inactiveAngle:d.inactiveAngle))+", M22=1";if(m==d.currentElem){j.width=d.itemSize*(1-((k)*(1-d.inactiveScale)));j.height=j.width*(d.itemHeight/d.itemSize);j.top=-((j.height-d.itemHeight)/3)}else{j.width=d.itemSize*(d.inactiveScale);j.height=d.itemHeight*(d.inactiveScale);j.top=0}}else{j[d.prefix+"transform"]="matrix(1,"+(k*(l=="right"?-d.inactiveAngle:d.inactiveAngle))+",0,1,0,0) scale("+(1-((k)*(1-d.inactiveScale)))+")"}j.left=((m*d.spaceBetween));$(this).css(j)})},selectElement:function(d){var f=this.options,h=$(this.element).find(f.childElem);f.previousElem=f.currentElem;f.currentElem=$(d).index();$(".sliderCover").slider({value:f.currentElem});clearInterval(f.loadTimer);var b=this,g=Math.abs(f.previousElem-f.currentElem)<=1?f.previousElem:f.currentElem+(f.previousElem<f.currentElem?-1:1);$.fx.step.coverflow=function(i){b._refresh(i.now,g,f.currentElem)};var e={coverflow:1},c=0;if(f.recenter){c=((f.currentElem)*f.spaceBetween)-(f.containerWidth/2-f.itemSize/2)}e.left=-c;this.element.find("ul").stop().animate(e,{duration:f.duration,easing:"easeOutQuint"})},getPrefix:function(){var d=String(window.navigator.userAgent).toLowerCase();var c=d.match(/applewebkit|firefox|msie/);var b={applewebkit:"-webkit-",firefox:"-moz-",msie:"-ms-"};if(c==null){this.options.prefix="u"}else{if(c.length>0){this.options.prefix=b[c[0]]}}}});var a={};$(".sliderCover").slider({min:0,max:$(".coverFlow li").length-1,value:1,});$(".coverFlow").coverflow(a)});